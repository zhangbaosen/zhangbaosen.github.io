<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>EE 554 Largescale Electric Systems Analysis Homework Assigments</title>
  <meta name="description" content="Baosen Zhang is an Associate Professor in the Electrical and Computer Engineering Department at the University of Washington.
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/teaching/EE554/homework6_solutions">
  <link rel="alternate" type="application/rss+xml" title="Baosen Zhang" href="http://localhost:4000/feed.xml">
     <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>


  <body>

    <header class="site-header">

<script src="https://techblog.lankes.org/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<script language="JavaScript" type="text/javascript">
<!--
function toggleDiv(element){
 if(document.getElementById(element).style.display == 'none')
  document.getElementById(element).style.display = 'block';
 else
       document.getElementById(element).style.display = 'none';
}
//-->
</script>
  
  <div class="wrapper">

    <a class="site-title" href="/">Baosen Zhang</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
         <ul class="menu">

    
     <li><a href="/about/" class="page-link">About</a>
    
    </li>
    
    
     <li><a href="/research/" class="page-link">Research</a>
    
    </li>
    
    
    <li><a href="/teaching/" class="page-link">Teaching</a>
    <ul class="sub-menu">
    
    <li><a href="/teaching">EE 351 – Introduction to Energy Systems</a></li>
    
    <li><a href="/teaching/EE451">EE 451 - Wind Energy</a></li>
    
    <li><a href="/teaching/EE454">EE 454 - Power System Analysis</a></li>
    
    <li><a href="/teaching/">EE 554 – Large Scale Power Systems</a></li>
    
    <li><a href="/teaching/EE553">EE 553 - Power System Economics</a></li>
    
    <li><a href="/teaching/EE559">EE 559 – Optimization of Networks and Graphs</a></li>
    
    </ul>
    
    </li>
    
    
     <li><a href="/group/" class="page-link">Group</a>
    
    </li>
    
    </ul>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">EE 554 Largescale Electric Systems Analysis Homework Assigments</h1>
  </header>

  <div class="post-content">
    <h1 id="homework-6">Homework 6</h1>

<p>Due  at 11:59pm on Dec 3. Submit to <a href="https://canvas.uw.edu/courses/1828831/assignments/10856279">https://canvas.uw.edu/courses/1828831/assignments/10856279</a>. Note, for the optimization problems, write out the formulation and provide the optimal value of the problem. You do not need to write out the optimal solutions unless instructed in a specific problem.</p>

<h2 id="problem-1">Problem 1</h2>

<p>In power system operations the cost of generators are often given as piecewise linear functions. For example, let \(C_1(x_1)\) and \(C_2(x_2)\) be given as</p>

\[C_1(x_1)= \begin{cases} 
	x_1 &amp; \mbox{ if }  0 \leq x_1 \leq 1 \\
	2 x_1-1 &amp; \mbox{ if } x_1 &gt; 1
	\end{cases}  
	\quad
	C_2(x_2)= \begin{cases} 
	0.5 x_2 &amp; \mbox{ if }  0 \leq x_2 \leq 2 \\
	3 x_2-5 &amp; \mbox{ if } x_2 &gt; 2
	\end{cases}\]

<p>We want to solve the following optimization problem</p>

\[\begin{align}
\min \; &amp; C_1(x_1)+C_2(x_2) \\ 
\mbox{s.t. } &amp;  x_1 \geq 0 \\
&amp; x_2 \geq 0 \\
&amp; x_1+x_2 = L 
\end{align}\]

<p>Write this optimization problem as a linear program, that is, a problem with just affine cost functions and affine constraints.</p>

<h3 id="solution">Solution.</h3>

<p>This is an example of the very useful fact that linear programs can encode some if/then statements. One can check that</p>

\[C_1(x_1)= \begin{align} \min \; &amp; u+2v \\ 
\mbox{s.t. } &amp; 0 \leq u \leq 1 \\ 
&amp; v \geq 0 \\ 
&amp; u+v=x_1 
\end{align}\]

<p>and</p>

\[C_2(x_2)= \begin{align} \min \; &amp; 0.5 y+3z \\ 
\mbox{s.t. } &amp; 0 \leq y \leq 2 \\ 
&amp; z \geq 0 \\ 
&amp; y+z=x_2 
\end{align}\]

<p>putting things together we can the optimization problem can be written as</p>

\[\begin{align}
\min \; &amp; u+2v+0.5 y+3z  \\ 
\mbox{s.t. } &amp;  0 \leq u \leq 1 \\ 
&amp; v \geq 0 \\ 
&amp; 0 \leq y \leq 2 \\ 
&amp; z \geq 0 \\ 
&amp; u+v+y+z = L 
\end{align}\]

<h2 id="problem-2">Problem 2</h2>

<p>We explore how to include energy storage in the optimization problem. A storage doesn’t generate net power, rather it has the ability to shift load around in time. A standard application of a storage is arbitrage, that is, buy low and sell high. The storage has some physical constraints. For example, the charge and discharge power must be limited by the rated power and the energy in the storage is bounded between 0 and some maximum state of charge (SoC).</p>

<p>Let’s consider 10 time slots. We assume perfect knowledge of the prices in these timeslots, and they are \(p=(1.3,2.8,4.1,3.6,1.9,5.0,2.2,3.4,4.8,1.7)\). Suppose the maximum SoC of the storage is 10 units, and the charge and discharge rate is 2 units of power at a time step. Assume the stoage starts with an SoC of 5 units.</p>

<p>a) Write an optimization problem that maximize the profit of the storage.</p>

<p>b) Let’s say we want the SoC to end a the same level at the end of the time period. Add that constraint and resolve the problem.</p>

<p>c) What is the marginal benefit of increasing the SoC (i.e., making the storage bigger)?</p>

<h3 id="solution-1">Solution.</h3>

<p>a) We define some variables. Let \(s_t\) be the SoC of the storage at time \(t\), \(x_t\) be the net discharge of the storage at time \(t\), and \(p_t\) be the price at time \(t\). The profit maximization problem is</p>

\[\begin{align}
\max \; &amp; \sum_{t=1}^{10} p_t x_t \\ 
\mbox{s.t. } &amp; s_t=s_{t-1}-x_t, \quad t \geq 2 \\ 
&amp; s_t = 5, \quad t =1 \\ 
&amp; 0 \leq s_t \leq 10 \\
&amp; -2 \leq x_t \leq 2 
\end{align}\]

<p>Solving this gives us the optimal profit is 33.4.</p>

<p>b) We add the constraint \(s_{10}=5\) and resolve it. The optimal solution is 20.4</p>

<p>c) This comes from reading the dual variables associated with the \(s_t \leq 10\) constraint (there are 10 constraints, one for each \(t\)). In this specific case we never actually hit the SoC upper bound, so all the dual variables are 0.</p>

<h2 id="problem-3">Problem 3</h2>

<p>We continue with the last problem and add in some more constraints.</p>

<p>a) Most storages are not 100% efficient. Suppose the storage has a charging efficiency of 90% (for every 1 unit of energy drawn from the grid, only 0.9 units gets to the SoC) and a discharging efficiency of 85% (for every 1 unit of energy out of the storage, only 0.85 units get to the grid). Add this to the optimization problem in 2b) and resolve.</p>

<p>b) There is some cost of using the storage, for example, batteries runs down faster if they are used more aggressively. In addition, the health of a battery storage degrades if it is either too full or too empty. Let’s say that every unit charged or discharged has a cost of \(1\), and if the storage incurs a flat cost of \(0.5\) per time unit if it is below 20% or above 80% SoC. Rewrite the optimization problem in part a) and resolve it.</p>

<h3 id="solution-2">Solution.</h3>

<p>a) We do this by introducing a charging variable and discharging variable, denoted by \(c_t\) and \(d_t\), respectively. The main change is in the objective and the SoC equation. In the objective, we have \(p_t (0.85 d_t-\frac{1}{0.9} c_t)\). The SoC update becomes \(s_t=s_{t-1}-d_t+c_t\). The overall optimization problem can be written as</p>

\[\begin{align}
\max \; &amp; \sum_{t=1}^{10} p_t (0.85 d_t-\frac{1}{0.9} c_t) \\ 
\mbox{s.t. } &amp; s_t=s_{t-1}-d_t+c_t, \quad t \geq 2 \\ 
&amp; s_t = 5, \quad t =1, 10 \\ 
&amp; 0 \leq s_t \leq 10 \\
&amp; 0 \leq d_t \leq 2 
&amp; 0 \leq c_t \leq 2
\end{align}\]

<p>Solving this gives an objective of 12.95.</p>

<p>You might have noticed that we allow both \(c_t\) and \(d_t\) to be nonzero. This should not happen in practice, since a storage shouldn’t charge and discharge at the same time. It turns out that if the efficiencies are not 1,  only one of \(c_t\) and \(d_t\) would be nonzero since it is not optimal otherwise. Showing this formally is a good excercise.</p>

<p>b) We add some cost functions to the objective. The power degradation costs are \(1 \cdot \vert c_t \vert\) and \(1 \cdot \vert d_t \vert\). The SoC costs can be written as \(0.5 I(s_t \leq 0.2)+0.5 I(s_t \geq 0.8)\) where \(I\) is the indicator function. The absolute value functions can be made into linear programming problems using similar techniques as in problem 1. The indicator functions are not convex, so any attempt here would get full marks.</p>

<h2 id="problem-4">Problem 4</h2>

<p>We continue with the previous problem. So far, we assumed that the price is known exactly. That is of course not the case in practice. Let’s say that there are two other possible prices, \((4.2,1.5,3.9,2.1,4.7,3.3,1.8,2.6,5.0,3.0)\) and \((2.4,4.9,1.1,3.7,2.0,4.4,1.6,3.2,2.9,4.0)\). Say the all three prices are equally likely to occur. Write and solve the optimization problem that takes this uncertainty into account.</p>

<h3 id="solution-3">Solution.</h3>

<p>There are multiple ways to handle this problem. The simplest would be simply take an average of the prices and optimize against that, which would maximize the expected profit. Or one could optimize the worst possible profit (a robust formation of the problem). Any reasonable formulation is ok.</p>

<h2 id="problem-5">Problem 5</h2>

<p>In this problem we formulate and solve a simple nonconvex loss minimization problem. 
A generator supplies a load through a transmission line modeled as a series admittance \(y := g - jb, \quad g &gt; 0, \; b &gt; 0\).
The voltage at the generator (reference) bus is fixed at \(V_0 := 1 \angle 0\). The required load power is \(S = P + jQ = |S| e^{j\phi}\), with \(P &gt; 0\) specified,
i.e., \(-S\) is the power injection at the load bus. Let the load voltage be \(V := v e^{j\theta}.\)</p>

<p>a) Show that the loss can be written as</p>

\[P_\text{loss} = r |I|^2 = g | 1 - v e^{j\theta} |^2.\]

<p>b) Fix \(v\) and \(P\).  Formulate the optimal power flow (OPF) as a minimization 
    over \((\theta, \phi)\) of the active line loss.</p>

<p>c) Reformulate the OPF as an unconstrained minimization \(\min_\phi f(\phi)\) over \(\phi\) only.</p>

<p>d) Find the unique minimize of \(f(\phi)\) over \(\phi \in [-\frac{\pi}{2},\frac{\pi}{2}]\).</p>

<h3 id="solution-4">Solution.</h3>

<p>In class we defined the thermal loss to be \(P_1+P_2\). Writing out the equations, we have \(P_1+P_2=Re\{V_1 (y(V_1-V_2))^*+V_2(y(V_2-V_1))^*\}= g(\vert V_1 \vert^2-V_1 V_2^*-V_1^* V_2+\vert V_2 \vert^2)\). Dividing and multiplying by \(\vert y \vert\) gives loss is equal to \(r \vert I \vert ^2\). The optimization problem can be written as</p>

\[\begin{align}
\min_{\theta, \phi} &amp; g | 1 - v e^{j\theta} |^2 \\ 
\mbox{s.t. } &amp; S= ve^{j \theta}(y(1-e^{j \theta}))^* \\
&amp; Re\{S\}=P \\ 
&amp; \angle S=\phi 
\end{align}\]

<p>This optimization problem look quite complicated. We can simplify this considerably by noticing that 
\(|S|= | ve^{j \theta}(y(1-e^{j \theta}))^*| = |y| |v| | 1-v e^{j\theta}|\) so we can solve \(| 1 - v e^{j\theta} |^2\) in \(|S|, |y|, v\). The objective becomes \(\frac{g}{|y|^2 v^2} |S|^2\). So if we can represent \(|S|^2\) in terms of \(\phi\), we can convert the problem to just optimizing over \(\phi\). Note that \(\phi\) is simply the angle of the complex number \(P+jQ\) and we know \(P\). So we need to write \(Q\) in terms of \(\phi\). Since we know \(P&gt;0\), \(\phi=\tan^{-1}(\frac{Q}{P})\) or \(Q=P\tan(\phi)\). The optimization problem becomes</p>

\[\min_{\phi} \; \frac{g}{|y|^2 v^2} (P^2+P^2 \tan^2(\phi))\]

<p>which is actually just minimizing \(\tan^2(\phi)\). And it is minimized when \(\phi=0\). This shows that to minimize loss to satisfy load \(P\), we want \(Q\) to be \(0\) (that is, the line should not unnecessarily transmit reactive power).</p>

<h2 id="problem-6">Problem 6</h2>

<p>This is a simplified example of voltage regulation in practice. Consider the system with the \(Y\)-bus matrix below.</p>

\[Y =
\begin{bmatrix}
0.83 - j1.47 &amp; -0.83 + j1.47 &amp; 0 &amp; 0 &amp; 0\\[4pt]
-0.83 + j1.47 &amp; 1.50 - j2.59 &amp; -0.67 + j1.12 &amp; 0 &amp; 0\\[4pt]
0 &amp; -0.67 + j1.12 &amp; 2.20 - j4.35 &amp; -0.95 + j1.89 &amp; -0.58 + j1.34\\[4pt]
0 &amp; 0 &amp; -0.95 + j1.89 &amp; 0.95 - j1.89 &amp; 0\\[4pt]
0 &amp; 0 &amp; -0.58 + j1.34 &amp; 0 &amp; 0.58 - j1.34
\end{bmatrix}.\]

<p>Suppose we want to minimize the loss while keeping all voltages at 1 per unit, with \(P\) and \(Q\) satisfying the upper bounds given below (the feeder, bus 1, is unconstrained).</p>

\[(\overline{P}_2,\overline{Q}_2)=(-0.05,0.3), (\overline{P}_3,\overline{Q}_3)=(-0.25,0.25), (\overline{P}_4,\overline{Q}_4)=(-0.2,0.06), (\overline{P}_5,\overline{Q}_5)=(-0.01,0.05)\]

<p>Write it as a semidefinite programming problem and solve it. Given the optimal solutions (the complex voltages) with the feeder as the slack bus.</p>

<h3 id="solution-5">Solution.</h3>

<p>Following the derivation in class, we can write \(P_i=Tr(A_i W)\) and \(Q_i=Tr(B_i W)\) for appropriately defined \(A_i\) and \(B_i\) matrices. Solving the SDP gives a \(W\) that is rank 1, and factoring it gives the complex voltages: \(V_1=1 \angle 0, \; V_2=1 \angle -35.71^\circ, \; V_3= 1 \angle -55.8^\circ, \; V_4 =1 \angle -72.05^\circ, \; V_5= 1 \angle -66.23^\circ\)</p>


  </div>

    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</article>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Baosen Zhang</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Baosen Zhang</li>
          <li><a href="mailto:zhangbao@uw.edu">zhangbao@uw.edu</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Baosen Zhang is an Associate Professor in the Electrical and Computer Engineering Department at the University of Washington.
</p>
      </div>
    </div>

  </div>

</footer>


   <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    
  </body>

</html>

